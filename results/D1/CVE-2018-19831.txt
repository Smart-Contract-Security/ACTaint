Solidity Version: 0.4.19
Switched global version to 0.4.19
==============Start====================
rules:
{Function:Mining24, Visibility:public, Explanation:Writes to variable minReq without any access control.}
{Function:Mining24, Visibility:public, Explanation:Writes to variable value without any access control.}
{Function:fallback, Visibility:public, Explanation:Writes to variable balances without any access control.}
{Function:Mining24, Visibility:public, Explanation:Writes to variable balances without any access control.}
{Function:ToOwner, Visibility:public, Explanation:Writes to variable balances without any access control.}
{Function:Mining24, Visibility:public, Explanation:Writes to variable owner without any access control.}
{Function:ToOwner, Visibility:public, Explanation:Writes to variable owner without any access control.}
{Function:withdrawForeignTokens, Visibility:public, Explanation:Transfers Ether or Token.}
{Function:withdraw, Visibility:public, Explanation:Transfers Ether or Token.}

=============Contract: Cryptbond
Sink:
Step 2: **Identify Sink**:

1. **Function `Mining24`:**
   - **Explanation**: This function has a `public` visibility and allows the caller to modify the `owner`, `value`, `minReq`, and `balances[msg.sender]` variables without any access control. This could lead to unauthorized changes to the contract's state, especially since it modifies the `owner` variable, allowing ownership to be changed arbitrarily.

2. **Function `ToOwner`:**
   - **Explanation**: This function also has a `public` visibility and allows the caller to set the `balances[msg.sender]` to the entire `totalSupply` and change the `owner` to the caller without any access control. This operation can be misused to transfer ownership or manipulate the balance.

3. **Function `withdrawForeignTokens`:**
   - **Explanation**: This function transfers tokens from the contract to the `owner`. Although it uses the `onlyOwner` modifier, it is considered a sink because it directly affects the token balance of the contract.

4. **Function `withdraw`:**
   - **Explanation**: This function transfers all Ether balance of the contract to the `owner`. Again, it uses the `onlyOwner` modifier, but is considered a sink because it transfers funds from the contract.

Step 3: **Self-Evaluate and Explain**:

1. **Function `Mining24`:**
   - **Sink**: The function is a sink because it allows changing critical state variables (`owner`, `value`, `minReq`, and `balances`) without access control, potentially allowing unauthorized access or modification.
   
2. **Function `ToOwner`:**
   - **Sink**: This function is a sink as it allows the caller to set themselves as the `owner` and allocate the total supply to their balance, bypassing intended access controls.

3. **Function `withdrawForeignTokens`:**
   - **Sink**: This function is considered a sink because it allows the `owner` to transfer tokens from the contract to themselves, which can be misused if ownership is compromised.

4. **Function `withdraw`:**
   - **Sink**: Similarly, this function is a sink as it allows the `owner` to withdraw all Ether from the contract, which can be a vulnerability if ownership control is not secure.

--Sink--:
{Function: Mining24, Sink: Unauthorized State Change, Visibility: public, Explanation: Allows setting `owner`, `value`, `minReq`, and `balances` without restriction}
{Function: ToOwner, Sink: Unauthorized State Change, Visibility: public, Explanation: Allows setting `owner` and transferring total supply to caller's balance without restriction}
{Function: withdrawForeignTokens, Sink: Unauthorized Token Transfer, Visibility: public, Explanation: Allows `owner` to transfer foreign tokens from contract}
{Function: withdraw, Sink: Unauthorized Ether Transfer, Visibility: public, Explanation: Allows `owner` to withdraw all Ether from the contract}
Report:
Let's analyze the provided smart contract, `Cryptbond`, focusing on whether untrusted inputs can reach any security-sensitive operations (sinks).

### Step 1: **Taint Source Analysis**

- **Function: Mining24**
  - **Taint Sources**: `msg.sender`, `_value`, `_minReq` (function parameters)
  - **Visibility**: Public function, hence it can be called by any external account.
  
- **Function: ToOwner**
  - **Taint Sources**: `msg.sender` (function can be called by any external account)
  - **Visibility**: Public function, so it can be called by any external account.

- **Function: withdrawForeignTokens**
  - **Taint Sources**: `msg.sender` (even though this function is protected by `onlyOwner`, it's part of the taint analysis)
  - **Visibility**: Public function, but protected by `onlyOwner`.

- **Function: withdraw**
  - **Taint Sources**: `msg.sender` (even though this function is protected by `onlyOwner`, it's part of the taint analysis)
  - **Visibility**: Public function, but protected by `onlyOwner`.

### Step 2: **Taint Propagation Path Analysis**

- **Function: Mining24**
  - **Taint Path**: Direct call from any account due to its public visibility. The function allows setting `owner`, `value`, `minReq`, and modifying `balances[msg.sender]` directly without restriction.
  - **Access Control**: No access control mechanisms are in place.

- **Function: ToOwner**
  - **Taint Path**: Direct call from any account due to its public visibility. The function allows setting `owner` and transferring the total supply to the caller's balance without restriction.
  - **Access Control**: No access control mechanisms are in place.

- **Function: withdrawForeignTokens**
  - **Taint Path**: `onlyOwner` modifier effectively restricts this function to the owner, blocking untrusted influence.
  - **Access Control**: The `onlyOwner` modifier restricts access to only the contract owner, preventing unauthorized token transfer.

- **Function: withdraw**
  - **Taint Path**: `onlyOwner` modifier effectively restricts this function to the owner, blocking untrusted influence.
  - **Access Control**: The `onlyOwner` modifier restricts access to only the contract owner, preventing unauthorized ether transfer.

### Step 3: **Self-Evaluation**

Analyzing the taint path and access control mechanisms, we find the following:

1. The `Mining24` function allows untrusted inputs to set critical state variables and balances without any access control.
2. The `ToOwner` function allows any user to claim ownership and allocate the total supply to their balance without restriction.

The functions `withdrawForeignTokens` and `withdraw` do not pose vulnerabilities due to the `onlyOwner` modifier effectively controlling access.

### Conclusion

--Vulnerability--:
{Function: Mining24, Taint Path: Direct public access, Description: Allows setting critical state variables and balances by any account without restriction}
{Function: ToOwner, Taint Path: Direct public access, Description: Allows transferring total supply to caller's balance and setting owner without restriction}

==============End======================
total time: 20.168089389801025
total token: 7078