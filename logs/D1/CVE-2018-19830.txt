Solidity Version: 0.4.24
Switched global version to 0.4.24
==============Start====================
rules:
{Function:UBSexToken, Visibility:public, Explanation:Writes to variable owner without any access control.}

=============Contract: BAFCToken
Sink:
The contract code provided is analyzed for security-sensitive operations that may cause access control vulnerabilities. Let's evaluate the code step-by-step to identify any potential sinks:

1. **Contract Analysis**:
    - The contract `BAFCToken` inherits from `StandardToken`, which is not provided but assumed to contain standard ERC-20 functionality.
    - Variables such as `name`, `symbol`, and `decimals` are defined with public visibility, allowing them to be accessed externally.
    - The constructor-like function `UBSexToken` is defined without the `constructor` keyword, indicating it is a function that can be called externally as it has public visibility.
    - This function initializes `owner` and `totalSupply` and assigns all tokens to the `owner`. Without access control, it can be called by any external account to reinitialize the contract state.

2. **Function Evaluation**:
    - `UBSexToken`: It sets the `owner` and assigns `totalSupply` to `balances[owner]`. It lacks access control, allowing any user to reset the contract's initial state, which is a critical vulnerability. This function is treated as a wrong constructor due to the lack of proper access restrictions.

3. **Fallback Function**:
    - The fallback function defined as `function () public payable { revert(); }` disallows ether transfers to the contract, ensuring that no unintended ether transactions occur. It does not contribute to any access control vulnerabilities.

4. **Identify Sink**:
    - The absence of a legitimate constructor and the presence of a public function that initializes critical state variables classify `UBSexToken` as a sink.

5. **Conclusion**:
    - The function `UBSexToken` is identified as a sink due to its public visibility and lack of access control, allowing unauthorized state modification.

Here's the final evaluation:

--Sink--:
{Function: UBSexToken, Sink: owner initialization, Visibility: public, Explanation: The function reinitializes contract state, setting owner and token balances without any access control. This can lead to unauthorized access and modification of the contract's critical state.}
Report:
Step 1: **Taint Source Analysis**

- The identified sink is in the function `UBSexToken`, specifically the initialization of `owner` and `balances[owner]` without any access control.
- `UBSexToken` is declared as a function, not a constructor, due to a lack of a `constructor` keyword. Its visibility is public.
- The `msg.sender` is the immediate taint source, as it is assigned to the `owner` variable directly. Since this function can be called by any external account, `msg.sender` is untrusted.

Step 2: **Taint Propagation Path**

- `UBSexToken` can be directly invoked by any external account due to its public visibility. There is no access control mechanism (e.g., `require` statement or modifier) to restrict its invocation.
- When `UBSexToken` is called, `msg.sender` (untrusted input) is assigned to `owner`, and `totalSupply` is assigned to `balances[owner]`. This represents a direct taint path from an untrusted source to the critical state variables of the contract.
- The absence of any access control checks or restrictions confirms that this taint path is not mitigated.

Step 3: **Self-Evaluation**

- The taint path from `msg.sender` to the sink (initialization of `owner` and `balances[owner]`) represents a direct access control vulnerability. This is because any external caller can reinitialize the contract's owner and balance, leading to unauthorized access and modification of critical state variables.

--Vulnerability--:
{Function:UBSexToken,Taint Path:msg.sender to owner and balances[owner],Description:Public function allows reinitialization of contract state, leading to unauthorized access and modification}

==============End======================
total time: 10.909263610839844
total token: 3278